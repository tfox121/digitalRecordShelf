(this["webpackJsonpdigital-record-shelf"]=this["webpackJsonpdigital-record-shelf"]||[]).push([[0],{199:function(e,t,a){e.exports=a(383)},204:function(e,t,a){},205:function(e,t,a){},206:function(e,t,a){},355:function(e,t,a){},383:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(42),l=a.n(c),u=(a(204),a(205),a(399)),s=a(392),o=a(401),i=a(27),m=Object(i.a)(),b=(a(206),a(384)),f=function(){return r.a.createElement("div",null,r.a.createElement(b.a,{as:"a",href:"http://www.last.fm/api/auth/?api_key=41a3c4831b1c49de2f9b2f0b1eb52dcb&cb=http://localhost:3000/auth/callback/"},"AUTH"))},p=a(24),d=a.n(p),h=a(44),E=a(402),g=a(45),v=a.n(g),k=v.a.create({baseURL:"https://subreddit-game-api.herokuapp.com/games"}),j=function(){var e=Object(h.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.post("/lastfm",{token:t});case 2:a=e.sent,console.log(a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=new URLSearchParams(Object(u.d)().search).get("token");console.log(e);return r.a.createElement("div",null,r.a.createElement(E.a,null,"CALLBACK"),r.a.createElement("p",null,"Token ="," ",e),r.a.createElement(b.a,{onClick:function(){j(e)}},"GET SESSION"))},O=a(112),w=a(35),S=a(398),y=a(393),C=a(186),T=a(395),A=a(394),R=a(46),I=function(e,t){for(var a,n,r=e.slice(0),c=e.length;c;)c-=1,a=r[n=Math.floor((c+1)*Math.random())],r[n]=r[c],r[c]=a;return r.slice(0,t)},H=a(400),D=a(109),L=a.n(D),F=(a(354),a(355),function(e){var t=e.albums,a=Object(n.useRef)(null),c=Object(n.useRef)(null),l=function(e){return e.preventDefault()},u=function(e){a.current.slideTo(e.item),c.current.slideTo(e.item)},i=t.map((function(e){return r.a.createElement(o.a,{basic:!0,inverted:!0,textAlign:"center"},r.a.createElement(C.a,{onDragStart:l,autoHeight:"true",src:e.image[3]["#text"]}),r.a.createElement(E.a,{as:"h5"},e.artist.name," ","-"," ",e.name))})),m=t.map((function(e){return r.a.createElement(s.a,null,r.a.createElement(C.a,{onDragStart:l,autoHeight:"true",src:e.image[3]["#text"]}))}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(L.a,{mouseTrackingEnabled:!0,onSlideChanged:u,items:i,dotsDisabled:"true",buttonsDisabled:"true",ref:a}),r.a.createElement(L.a,{mouseTrackingEnabled:!0,autoHeight:"true",onSlideChanged:u,items:m,ref:c,responsive:{0:{items:3},767:{items:4},1023:{items:5}}}))}),N=a(397),P=function(e){var t=e.albums;return console.log(t[0].tracks),r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{celled:!0,inverted:!0,unstackable:!0},r.a.createElement(N.a.Header,null,r.a.createElement(N.a.Row,null,r.a.createElement(N.a.HeaderCell,null,"Name"),r.a.createElement(N.a.HeaderCell,null,"Artist"),r.a.createElement(N.a.HeaderCell,null,"Plays"),r.a.createElement(N.a.HeaderCell,null,"Tracks"))),r.a.createElement(N.a.Body,null,t.map((function(e){return r.a.createElement(N.a.Row,{key:e.mbid},r.a.createElement(N.a.Cell,null,e.name),r.a.createElement(N.a.Cell,null,e.artist.name),r.a.createElement(N.a.Cell,null,e.playcount),r.a.createElement(N.a.Cell,null,e.tracks&&e.tracks.length))})))),r.a.createElement(E.a,{as:"h5",textAlign:"center"},"20 of"," ",t.length,"."))},U=function(e){var t=e.albums,a=Object(n.useState)("list"),c=Object(w.a)(a,2),l=c[0],u=c[1];if(!t[0]||!t[0].tracks)return null;var s=function(e,t){var a=t.name;return u(a)};return r.a.createElement("div",null,r.a.createElement(H.a,{inverted:!0,attached:"top",widths:"2",tabular:!0},r.a.createElement(H.a.Item,{name:"list",active:"list"===l,onClick:s}),r.a.createElement(H.a.Item,{name:"art",active:"art"===l,onClick:s})),r.a.createElement("div",{style:{display:"".concat("list"===l?"block":"none")}},r.a.createElement(P,{albums:t})),r.a.createElement("div",{style:{display:"".concat("art"===l?"block":"none")}},r.a.createElement(F,{albums:t})))},_=function(){var e=Object(n.useState)(!1),t=Object(w.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)("foxtrapper121"),u=Object(w.a)(l,2),s=u[0],i=u[1],m=Object(n.useState)([]),b=Object(w.a)(m,2),f=b[0],p=b[1],g=Object(n.useState)([]),k=Object(w.a)(g,2),j=k[0],x=k[1],H=Object(n.useState)([]),D=Object(w.a)(H,2),L=D[0],F=D[1],N=Object(n.useState)([]),P=Object(w.a)(N,2),_=P[0],B=P[1];Object(n.useEffect)((function(){if(!_.length&&j&&L){var e=0;console.log("PREFILTER",f,_);var t=f.filter((function(t){return!j.find((function(e){return e.name===t.name}))&&!L.find((function(e){return e.name===t.artist.name}))&&(!t.tracks||t.tracks.length>4)||(e+=1,!1)}));console.log(e),B(t),console.log("FILTERED",t),console.log("ARTISTS",L)}}),[f]),Object(n.useEffect)((function(){_.length&&!0===a&&c(!1)}),[_]);var M=function(){var e=Object(h.a)(d.a.mark((function e(t){var a,n,r,c,l,u,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="http://ws.audioscrobbler.com/2.0/",n={method:"album.getInfo",artist:t.artist.name,album:t.name,autocorrect:1,api_key:"41a3c4831b1c49de2f9b2f0b1eb52dcb",format:"json"},e.prev=2,e.next=5,v.a.get(a,{params:n});case 5:if((r=e.sent).data.album){e.next=16;break}return e.next=9,v.a.get(a,{params:{method:"album.search",limit:"1",album:t.name,api_key:"41a3c4831b1c49de2f9b2f0b1eb52dcb",format:"json"}});case 9:if(!(r=e.sent).data.results.albummatches.album[0].name){e.next=16;break}return c=r.data.results.albummatches.album[0],l=Object(O.a)({},n,{artist:c.artist,album:c.name}),e.next=15,v.a.get(a,{params:l});case 15:r=e.sent;case 16:if(!r.data.album){e.next=20;break}return u=r.data.album.tracks.track,s=Object(O.a)({},t,{tracks:u,ratio:t.playcount/u.length}),e.abrupt("return",s);case 20:return console.log("MISSING",t.name,t.artist.name),e.abrupt("return",t);case 24:return e.prev=24,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return",null);case 28:case"end":return e.stop()}}),e,null,[[2,24]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(h.a)(d.a.mark((function e(t,a,n,r,c){var l,u,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"http://ws.audioscrobbler.com/2.0/",l={method:t,user:a,limit:r,period:n,api_key:"41a3c4831b1c49de2f9b2f0b1eb52dcb",format:"json"},e.prev=2,e.next=5,v.a.get("http://ws.audioscrobbler.com/2.0/",{params:l});case 5:if(u=e.sent,"user.getTopAlbums"!==t){e.next=16;break}if("overall"!==n){e.next=13;break}return e.next=10,Promise.all(u.data.topalbums.album.map(function(){var e=Object(h.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",M(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 10:(s=e.sent).sort((function(e,t){return e.ratio>t.ratio?-1:e.ratio<t.ratio?1:0})),c(s);case 13:c(u.data.topalbums.album),e.next=17;break;case 16:c(u.data.topartists.artist);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2),console.error(e.t0);case 22:case"end":return e.stop()}}),e,null,[[2,19]])})));return function(t,a,n,r,c){return e.apply(this,arguments)}}(),J=function(){var e=Object(h.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),c(!0),e.next=4,G("user.getTopAlbums",s,"12month",100,x);case 4:return e.next=6,G("user.getTopArtists",s,"6month",75,F);case 6:return e.next=8,G("user.getTopAlbums",s,"overall",275,p);case 8:c(!1);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{content:"Digital Record Shelf"}),r.a.createElement(T.a,{action:"submit",onSubmit:J},r.a.createElement(T.a.Field,null,r.a.createElement(A.a,{inverted:!0,icon:!0,placeholder:"Your Last.fm Username..."},r.a.createElement("input",{value:s,onChange:function(e){return i(e.target.value)}}),r.a.createElement(R.a,{name:"search"})))),a?r.a.createElement(o.a,null,r.a.createElement(S.a,{active:!0},r.a.createElement(y.a,{indeterminate:!0},"Retrieving Albums")),r.a.createElement(C.a,{src:"https://react.semantic-ui.com/images/wireframe/short-paragraph.png"})):r.a.createElement(U,{albums:I(_,15)}))},B=function(){return r.a.createElement(u.b,{history:m},r.a.createElement(s.a,null,r.a.createElement(o.a,{inverted:!0,className:"app"},r.a.createElement(u.c,null,r.a.createElement(u.a,{path:"/",exact:!0,component:_}),r.a.createElement(u.a,{path:"/auth",exact:!0,component:f}),r.a.createElement(u.a,{path:"/auth/callback/",exact:!0,component:x})))))};l.a.render(r.a.createElement(B,null),document.getElementById("root"))}},[[199,1,2]]]);
//# sourceMappingURL=main.86ce21b0.chunk.js.map